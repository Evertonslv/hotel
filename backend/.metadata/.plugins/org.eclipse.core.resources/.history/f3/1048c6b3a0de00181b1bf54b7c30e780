package com.hotel.model.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;

import com.hotel.model.Checkin;
import com.hotel.model.config.Conexao;

public class CheckinDAO {

	public boolean inserir(Checkin checkin)
	{
		String sql = "INSERT INTO checkib(datent_che,datsai_che,veicul_che,codhos_che) VALUES(?,?,?,?)";
		Boolean retorno = false;
		PreparedStatement pst = Conexao.getPreparedStatement(sql);
		try {
			pst.setString(1, checkin.getDataEntrada());
			pst.setString(2, checkin.getDataSaida());
			pst.setString(3, (checkin.isVeiculo() ? "1" : "0"));
			pst.setInt(4, checkin.getCodigoHospede());

			if(pst.executeUpdate()>0)
			{
				retorno = true;
			}



		} catch (SQLException ex) {
			Logger.getLogger(CheckinDAO.class.getName()).log(Level.SEVERE, null, ex);
			retorno = false;
		}

		return retorno;

	}
	public boolean atualizar(Checkin checkin)
	{
		String sql = "UPDATE checkin set datent_che=?,datsai_che=?,veicul_che=? where codigo_che=?";
		Boolean retorno = false;
		PreparedStatement pst = Conexao.getPreparedStatement(sql);

		try {

			pst.setString(1, checkin.getDataEntrada());
			pst.setString(2, checkin.getDataSaida());
			pst.setString(3, (checkin.isVeiculo() ? "1" : "0"));
			pst.setInt(4, checkin.getCodigo());

			if(pst.executeUpdate()>0)
			{
				retorno = true;
			}



		} catch (SQLException ex) {
			Logger.getLogger(CheckinDAO.class.getName()).log(Level.SEVERE, null, ex);
			retorno = false;
		}

		return retorno;

	}
	public boolean excluir(Checkin checkin)
	{
		String sql = "DELETE FROM checkin where codigo_che=?";
		Boolean retorno = false;
		PreparedStatement pst = Conexao.getPreparedStatement(sql);

		try {
			pst.setInt(1, checkin.getCodigo());

			if(pst.executeUpdate()>0)
			{
				retorno = true;
			}            

		} catch (SQLException ex) {
			Logger.getLogger(CheckinDAO.class.getName()).log(Level.SEVERE, null, ex);
			retorno = false;
		}

		return retorno;

	}

	public List<Checkin> listarHospedeCheckin()
	{
		String sql = "SELECT * FROM usuario";
		List<Checkin> retorno = new ArrayList<Checkin>();

		PreparedStatement pst = Conexao.getPreparedStatement(sql);
		try {           

			ResultSet res = pst.executeQuery();
			while(res.next())
			{
				Checkin checkin = new Checkin();
				checkin.setCodigo(Integer.parseInt(res.getString("login")));
				checkin.setDataEntrada(res.getString("senha"));
				checkin.setDataSaida(res.getString("email"));
				checkin.setVeiculo(res.getString("perfil").equals("1"));

				retorno.add(checkin);
			}



		} catch (SQLException ex) {
			Logger.getLogger(CheckinDAO.class.getName()).log(Level.SEVERE, null, ex);

		}

		return retorno;


	}

	public List<Checkin> listarHospedeSemCheckin()
	{
		String sql = "SELECT * FROM usuario";
		List<Checkin> retorno = new ArrayList<Checkin>();

		PreparedStatement pst = Conexao.getPreparedStatement(sql);
		try {           

			ResultSet res = pst.executeQuery();
			while(res.next())
			{
				Checkin checkin = new Checkin();
				checkin.setCodigo(Integer.parseInt(res.getString("login")));
				checkin.setDataEntrada(res.getString("senha"));
				checkin.setDataSaida(res.getString("email"));
				checkin.setVeiculo(res.getString("perfil").equals("1"));

				retorno.add(checkin);
			}



		} catch (SQLException ex) {
			Logger.getLogger(CheckinDAO.class.getName()).log(Level.SEVERE, null, ex);

		}

		return retorno;


	}

	public Checkin buscar(int codigo)
	{
		String sql = "SELECT * FROM usuario where login=?";
		Checkin checkin = null;

		PreparedStatement pst = Conexao.getPreparedStatement(sql);
		try {

			pst.setInt(1, codigo);
			ResultSet res = pst.executeQuery();

			if(res.next())
			{
				checkin = new Checkin();
				checkin.setCodigo(Integer.parseInt(res.getString("login")));
				checkin.setDataEntrada(res.getString("senha"));
				checkin.setDataSaida(res.getString("email"));
				checkin.setVeiculo(res.getString("perfil").equals("1"));


			}



		} catch (SQLException ex) {
			Logger.getLogger(CheckinDAO.class.getName()).log(Level.SEVERE, null, ex);

		}

		return checkin;

	}

}
